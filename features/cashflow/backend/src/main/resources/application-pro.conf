# Self-hosting (Pro) configuration
# Goal: keep only secrets in env (.env), everything else is fixed here.

include "application.conf"

ktor.deployment.environment = "selfhost"

database {
    url = "jdbc:postgresql://postgres:5432/dokus"
    username = "dokus"
    password = ${DB_PASSWORD}

    pool {
        maxSize = 20
        minSize = 5
    }
}

jwt {
    secret = ${JWT_SECRET}
    issuer = "dokus"
    audience = "dokus-api"
}

security.cors.allowedHosts = "*"

caching {
    type = "redis"
    redis {
        host = "redis"
        port = 6379
        password = ${REDIS_PASSWORD}
        database = 0
    }
}

rabbitmq {
    host = "rabbitmq"
    port = 5672
    username = "dokus"
    password = ${RABBITMQ_PASSWORD}
    virtualHost = "/dokus"
}

minio {
    endpoint = "http://minio:9000"
    accessKey = "dokusadmin"
    secretKey = ${MINIO_PASSWORD}
    bucket = "dokus-documents"
}

server.environment = "selfhost"

# Storage public URL (set via environment variable)
storage.publicUrl = ${STORAGE_PUBLIC_URL}
